<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


    <bean name="findHolidayNextWeek" class="java.lang.String">
        <constructor-arg>
            <value>
                SELECT FN_SIGLA_FILIAL(C.ID_FILIAL) FILIAL,
                COL_FERIADO_DATA DATA,
                COL_FERIADO_DESCR DESCRICAO,
                COL_FERIADO_TIPO TIPO_FERIADO,
                COL_FERIADO_UF UF
                FROM COL_FERIADO C
                LEFT JOIN EMP_FILIAL F ON F.ID_FILIAL = C.ID_FILIAL
                LEFT JOIN CEP_LOCALIDADE CL ON CL.ID_CEP_LOCALIDADE = C.ID_CEP_LOCALIDADE
                WHERE ( CL.CEP_LOC_NOME = F.EMP_FIL_CIDADE OR C.ID_FILIAL IS NULL) AND
                COL_FERIADO_DATA &gt;= TRUNC(SYSDATE) AND COL_FERIADO_DATA &lt; TRUNC(SYSDATE)+7
            </value>
        </constructor-arg>
    </bean>

    <bean name="findTpPendingEmail" class="java.lang.String">
        <constructor-arg>
            <value>
                SELECT TPCON.ID_CRM_ENVIA_TP_PER_CONTATO ID_CONTATO,
                TPCON.CRM_ETPC_EMAIL_CONTATO EMAIL_CONTATO,
                TPPE.ID_EMI_CONHECIMENTO ID_CONHECIMENTO,
                TPCON.ID_CRM_CONTATO_CLIENTE ID_CLIENTE,
                TPPE.CRM_ETP_SEQ NUM_COMUNICADO
                FROM CRM_ENVIA_TP_PER_CONTATO TPCON
                JOIN CRM_ENVIA_TP_PERIODO TPPE ON TPPE.ID_CRM_ENVIA_TP_PERIODO = TPCON.ID_CRM_ENVIA_TP_PERIODO
                WHERE TPCON.CRM_ETPC_DT_ENVIO IS NULL AND ROWNUM &lt; 4001 AND TPPE.CRM_ETP_SEQ &gt; 0
            </value>
        </constructor-arg>
    </bean>

    <bean name="findTpFirstPendingEmail" class="java.lang.String">
        <constructor-arg>
            <value>
                select *
                from ENVIO_TP e
                WHERE e.ENVIADO = 0
                AND ROWNUM &lt; 20001
                ORDER BY e.ID
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateTpAgrupada" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE CRM_ENVIA_TP_PER_CONTATO SET CRM_ETPC_AGRUPADO = 1 WHERE ID_CRM_ENVIA_TP_PER_CONTATO = ?
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateTpFirstContato" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE CRM_ENVIA_TP_PER_CONTATO SET CRM_ETPC_DT_ENVIO = SYSDATE
                WHERE ID_CRM_ENVIA_TP_PER_CONTATO in
                (select ID_CRM_ENVIA_TP_PER_CONTATO from ENVIO_TP_DETALHES WHERE ID_ENVIO_TP = ?)
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateTpContato" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE CRM_ENVIA_TP_PER_CONTATO SET CRM_ETPC_DT_ENVIO = SYSDATE WHERE ID_CRM_ENVIA_TP_PER_CONTATO = ?
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateTpEnviada" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE ENVIO_TP SET ENVIADO = 1 WHERE ID = ?
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateStartJob" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE APP_MONITOR SET APP_MONITOR_DATA = SYSDATE, APP_MONITOR_DATA_FIM = NULL WHERE APP_MONITOR_NOME = ?
            </value>
        </constructor-arg>
    </bean>

    <bean name="updateFinishJob" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE APP_MONITOR SET APP_MONITOR_DATA_FIM = SYSDATE, APP_MONITOR_QTDE_REG = ? WHERE APP_MONITOR_NOME = ?
            </value>
        </constructor-arg>
    </bean>

    <bean name="findTpGroupingConhec" class="java.lang.String">
        <constructor-arg>
            <value>
                SELECT  M.ID_FILIAL_DESTINO || '|' || M.ID_TAR_MODAL || '|' || TPCON.ID_CRM_CONTATO_CLIENTE || '|' || TPCON.CRM_ETPC_EMAIL_CONTATO  AS GRUPO,
                TPPE.ID_EMI_CONHECIMENTO,
                TPPE.ID_CRM_ENVIA_TP_PERIODO,
                TPCON.ID_CRM_ENVIA_TP_PER_CONTATO,
                TPCON.CRM_ETPC_EMAIL_CONTATO EMAIL
                FROM CRM_ENVIA_TP_PER_CONTATO TPCON
                JOIN CRM_ENVIA_TP_PERIODO TPPE ON TPPE.ID_CRM_ENVIA_TP_PERIODO = TPCON.ID_CRM_ENVIA_TP_PERIODO
                JOIN  EMI_CONHECIMENTO M ON M.ID_EMI_CONHECIMENTO  = TPPE.ID_EMI_CONHECIMENTO
                WHERE TPPE.CRM_ETP_SEQ = 0
                AND TPCON.CRM_ETPC_DT_ENVIO IS NULL
                AND NVL(TPCON.CRM_ETPC_AGRUPADO,0) = 0
                AND ((TPPE.CRM_ETP_DT_INCLUSAO &lt; TO_DATE(TO_CHAR(SYSDATE-1,'DD/MM/YYYY') || ' 12:00:00','DD/MM/YYYY HH24:MI:SS'))
                OR
                ((TPPE.CRM_ETP_DT_INCLUSAO BETWEEN TO_DATE(TO_CHAR(SYSDATE-1,'DD/MM/YYYY') || ' 12:00:00','DD/MM/YYYY HH24:MI:SS')  AND
                TO_DATE(TO_CHAR(SYSDATE,  'DD/MM/YYYY') || ' 12:00:00','DD/MM/YYYY HH24:MI:SS'))
                AND SYSDATE &gt;= TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY') || ' 12:00:00','DD/MM/YYYY HH24:MI:SS')
                )
                )
                ORDER BY M.ID_FILIAL_DESTINO || '|' || M.ID_TAR_MODAL || '|' || TPCON.ID_CRM_CONTATO_CLIENTE || '|' || TPCON.CRM_ETPC_EMAIL_CONTATO, TPPE.ID_EMI_CONHECIMENTO
            </value>
        </constructor-arg>
    </bean>


    <bean name="findSolicitacaoDownload" class="java.lang.String">
        <constructor-arg>
            <value>
                select ID,
                ID_HASH,
                EMAIL
                from solicitacao_download
                WHERE ENVIADO = 0 AND DATA_SOLICITACAO &lt;=  ( sysdate - interval '1' hour)
            </value>
        </constructor-arg>
    </bean>


    <bean name="updateSolicitacaoDownload" class="java.lang.String">
        <constructor-arg>
            <value>
                UPDATE SOLICITACAO_DOWNLOAD SET ENVIADO = 1 WHERE ID = ?
            </value>
        </constructor-arg>
    </bean>


</beans>
